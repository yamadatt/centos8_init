- name: install epel-release
  dnf:
    name: epel-release
    state: present

- name: dnf install
  dnf:
    name: "{{packages}}"
  vars:
    packages:
      - dkms
    enablerepo: epel

- name: dnf install
  dnf:
    name: "{{packages}}"
  vars:
    packages:
      - nkf
    enablerepo: PowerTools

- name: dnf install
  dnf:
    name: "{{packages}}"
  vars:
    packages:
      - ccid
#      - pcsc-lite-devel
    enablerepo: epel

- name: download & unarchive pcsc-perl
  unarchive:
    src: http://search.cpan.org/CPAN/authors/id/W/WH/WHOM/pcsc-perl-1.4.13.tar.bz2
    dest: "{{ src_dir }}"
    copy: no

- name: perl Makefile.PL #makeファイルが作成されない場合のエラー処理入れたい　
  shell: cd /usr/local/src/pcsc-perl-1.4.13/ && perl Makefile.PL



- name: make all
  make:
    chdir: "{{ src_dir }}/pcsc-perl-1.4.13"
    target: all
      
- name: make install
  make:
    chdir: "{{ src_dir }}/pcsc-perl-1.4.13"
    target: install
  become: yes



- name: download & unarchive pcsc-tools
  unarchive:
    src: https://launchpad.net/ubuntu/+archive/primary/+files/pcsc-tools_1.4.23.orig.tar.gz
    dest: "{{ src_dir }}"
    copy: no


- name: make all
  make:
    chdir: "{{ src_dir }}/pcsc-tools-1.4.23"
    target: all
      
- name: make install
  make:
    chdir: "{{ src_dir }}/pcsc-tools-1.4.23"
    target: install
  become: yes




